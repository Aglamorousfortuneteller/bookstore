{% extends 'base.html' %}
{% block title %}–ö–æ—Ä–∑–∏–Ω–∞{% endblock %}
{% block content %}
<h1>üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h1>

{% if cart_items %}
<form method="post" action="{{ url_for('checkout') }}">
    <label>
        <input type="checkbox" id="select-all" onclick="
            var checkboxes = document.querySelectorAll('.item-checkbox');
            for (var i = 0; i < checkboxes.length; i++) checkboxes[i].checked = this.checked;
        "> –í—ã–±—Ä–∞—Ç—å –≤—Å–µ
    </label>

    <ul style="list-style: none; padding-left: 0;">
        {% for item in cart_items %}
        <li style="display: flex; align-items: center; gap: 15px; margin-bottom: 10px;">
            <input type="checkbox" class="item-checkbox" name="selected_items" value="{{ item.id }}">
            <img src="https://media.istockphoto.com/id/162833278/nl/foto/blank-book.jpg?s=612x612&w=0&k=20&c=C-kb218UqFZ_ZdWg8ILDDcXDwpmYzwghnew_7VWZwm4=" style="width: 60px; height: auto; border: 1px solid #ccc;">
            <div style="flex: 1;">
                <strong>{{ item.book.title }}</strong><br>
                –ê–≤—Ç–æ—Ä: {{ item.book.author }}<br>
                –ì–æ–¥: {{ item.book.year }}<br>
                –¶–µ–Ω–∞: {{ item.book.price }} ‚ÇΩ
            </div>
            <!-- –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ –≤–Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ—Ä–º—ã -->
            <form method="post" action="{{ url_for('update_cart_item', item_id=item.id) }}">
                <input type="number" name="quantity" value="{{ item.quantity }}" min="1" style="width: 60px;" onchange="this.form.submit();">
            </form>
        </li>
        {% endfor %}
    </ul>

    <p><strong>–ò—Ç–æ–≥–æ:</strong> {{ "%.2f"|format(total) }} ‚ÇΩ</p>

    <!-- –≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫–∞ –≤–º–µ—Å—Ç–æ –∫–Ω–æ–ø–∫–∏ -->
    <button type="submit" style="display: inline-block; background: none; border: none; color: blue; text-decoration: underline; cursor: pointer; padding: 0;">–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é</button>
</form>
{% else %}
<p>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞.</p>
{% endif %}

{% with messages = get_flashed_messages(with_categories=true) %}
  {% for category, message in messages %}
    <div class="flash {{ category }}">{{ message }}</div>
  {% endfor %}
{% endwith %}

<br>
<a href="{{ url_for('index') }}">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
{% endblock %}
